syntax = "proto2";

package src.controls;

message Sensors {
  optional double time                                                     = 1;
  required double latitude                                                 = 2;
  required double longitude                                                = 3;
  required float altitude                                                  = 4;
  required float relative_altitude                                         = 5;
  required float heading                                                   = 6;

  required float velocity_x                                                = 7;
  required float velocity_y                                                = 8;
  required float velocity_z                                                = 9;

  required float gps_ground_speed                                          = 10;

  required int32 gps_satellite_count                                       = 11;
  required int32 gps_eph                                                   = 12;
  required int32 gps_epv                                                   = 13;

  required float accelerometer_x                                           = 14;
  required float accelerometer_y                                           = 15;
  required float accelerometer_z                                           = 16;

  required float gyro_x                                                    = 17;
  required float gyro_y                                                    = 18;
  required float gyro_z                                                    = 19;

  required float absolute_pressure                                         = 20;
  required float relative_pressure                                         = 21;
  required float pressure_altitude                                         = 22;
  required float temperature                                               = 23;

  required float battery_voltage                                           = 24;
  required float battery_current                                           = 25;

  required bool armed                                                      = 26;
  required int32 autopilot_state                                           = 27;

  required double last_gps                                                 = 28;
}

message Goal {
  required bool run_mission                                                = 1;

  required bool trigger_failsafe                                           = 2;
  required bool trigger_throttle_cut                                       = 3;

  required double trigger_takeoff                                          = 4;
  required double trigger_hold                                             = 5;
  required double trigger_offboard                                         = 6;
  required double trigger_rtl                                              = 7;
  required double trigger_land                                             = 8;
  required double trigger_arm                                              = 9;
  required double trigger_disarm                                           = 10;

  required double trigger_alarm                                            = 11;
  required double trigger_bomb_drop                                        = 12;
  required double trigger_dslr                                             = 13;
}

message Output {
  required int32 state                                                     = 1;
  required double flight_time                                              = 2;
  required int32 current_command_index                                     = 3;

  required float velocity_x                                                = 4;
  required float velocity_y                                                = 5;
  required float velocity_z                                                = 6;
  required float yaw_setpoint                                              = 7;

  required float gimbal_angle                                              = 8;
  required bool bomb_drop                                                  = 9;
  required bool alarm                                                      = 10;
  required bool dslr                                                       = 11;

  required double trigger_takeoff                                          = 12;
  required double trigger_hold                                             = 13;
  required double trigger_offboard                                         = 14;
  required double trigger_rtl                                              = 15;
  required double trigger_land                                             = 16;
  required double trigger_arm                                              = 17;
  required double trigger_disarm                                           = 18;
}

message UasMessage {
  optional double time                                                     = 1;

  oneof payload {
    Sensors sensors                                                        = 2;
    Goal goal                                                              = 3;
    Output output                                                          = 4;
  }
}

// New sensor messages (directly from Mavlink)
message SensorsHeartbeat {
  required float autopilot                                                 = 1;
  required float base_mode                                                 = 2;
  required float custom_mode                                               = 3;
  required float mavlink_version                                           = 4;
  required float system_status                                             = 5;
  required float type                                                      = 6;
}

message SensorsSysStatus {
  required float battery_remaining                                         = 1;
  required float current_battery                                           = 2;
  required float drop_rate_comm                                            = 3;
  required float errors_comm                                               = 4;
  required float errors_count1                                             = 5;
  required float errors_count2                                             = 6;
  required float errors_count3                                             = 7;
  required float errors_count4                                             = 8;
  required float load                                                      = 9;
  required float onboard_control_sensors_enabled                           = 10;
  required float onboard_control_sensors_health                            = 11;
  required float onboard_control_sensors_present                           = 12;
  required float voltage_battery                                           = 13;
}

message SensorsBatteryStatus {
  required float battery_function                                          = 1;
  required float battery_remaining                                         = 2;
  required float charge_state                                              = 3;
  required float current_battery                                           = 4;
  required float current_consumed                                          = 5;
  required float energy_consumed                                           = 6;
  required float id                                                        = 7;
  required float temperature                                               = 8;
  required float time_remaining                                            = 9;
  required float type                                                      = 10;
  repeated float voltages                                                  = 11;
}

message SensorsRadioStatus {
  required float fixed                                                     = 1;
  required float noise                                                     = 2;
  required float remnoise                                                  = 3;
  required float remrssi                                                   = 4;
  required float rssi                                                      = 5;
  required float rxerrors                                                  = 6;
  required float txbuf                                                     = 7;
}

message SensorsLocalPositionNed {
  required float x                                                         = 1;
  required float y                                                         = 2;
  required float z                                                         = 3;
  required float vx                                                        = 4;
  required float vy                                                        = 5;
  required float vz                                                        = 6;
}

message SensorsGlobalPositionInt {
  required float alt                                                       = 1;
  required float hdg                                                       = 2;
  required float lat                                                       = 3;
  required float lon                                                       = 4;
  required float relative_alt                                              = 5;
  required float time_boot_ms                                              = 6;
  required float vx                                                        = 7;
  required float vy                                                        = 8;
  required float vz                                                        = 9;
}

message SensorsGpsRawInt {
  required float alt                                                       = 1;
  required float alt_ellipsoid                                             = 2;
  required float cog                                                       = 3;
  required float eph                                                       = 4;
  required float epv                                                       = 5;
  required float fix_type                                                  = 6;
  required float h_acc                                                     = 7;
  required float hdg_acc                                                   = 8;
  required float lat                                                       = 9;
  required float lon                                                       = 10;
  required float satellites_visible                                        = 11;
  required float time_usec                                                 = 12;
  required float v_acc                                                     = 13;
  required float vel                                                       = 14;
  required float vel_acc                                                   = 15;
}

message SensorsHighresImu {
  required float abs_pressure                                              = 1;
  required float diff_pressure                                             = 2;
  required float fields_updated                                            = 3;
  required float pressure_alt                                              = 4;
  required float temperature                                               = 5;
  required float time_usec                                                 = 6;
  required float xgyro                                                     = 7;
  required float zgyro                                                     = 8;
  required float ygyro                                                     = 9;
  required float xacc                                                      = 10;
  required float yacc                                                      = 11;
  required float zacc                                                      = 12;
  required float xmag                                                      = 13;
  required float ymag                                                      = 14;
  required float zmag                                                      = 15;
}

message SensorsAttitude {
  required float pitch                                                     = 1;
  required float roll                                                      = 2;
  required float yaw                                                       = 3;
  required float pitchspeed                                                = 4;
  required float rollspeed                                                 = 5;
  required float yawspeed                                                  = 6;
}

message SensorsVfrHud {
  required float airspeed                                                  = 1;
  required float alt                                                       = 2;
  required float climb                                                     = 3;
  required float groundspeed                                               = 4;
  required float heading                                                   = 5;
  required float throttle                                                  = 6;
}

message SensorsActuatorControlTarget {
  repeated float controls                                                  = 1;
  required float group_mlx                                                 = 2;
  required float time_usec                                                 = 3;
}
